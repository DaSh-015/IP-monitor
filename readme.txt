IP monitor v.1.1.0

Настройка:
Открой ip_monitor.ps1 через блокнот.
В самом верху, в строке $Processes укажи процессы, которые нужно мониторить без .exe на конце (можно посмотреть в диспетчере задач).
Также можно настроить путь, куда будут выгружаться логи - для этого в строке $OutDir заменить $PSScriptRoot на нужный путь. По умолчанию логи выгружаются в папку скрипта.
Строка $PollSeconds - как часто скрипт будет проверять IP процессов.
Строка $FlushSummarySeconds - как часто скрипт будет обновлять файл ip_summary.csv с информацией, собранной в удобном виде.

Для запуска скрипта создай ярлык со следующими параметрами (path замени на свой путь к папке скрипта):
powershell.exe -NoExit -ExecutionPolicy Bypass -File "path\IP monitor\ip_monitor_control.ps1"

Файл ip_summary.csv содержит следующие колонки:
IP - конкретный удалённый IPv4-адрес, с которым был замечен процесс
Hits - сколько раз этот IP попал в выборку за время работы скрипта (это не количество TCP-сессий, а количество наблюдений)
Polls - сколько раз процесс был обнаружен в работающем состоянии во время опросов
Share - Hits / Polls
FirstSeen - когда IP впервые появился
LastSeen - последний момент наблюдения
SeenMinutes - сколько минут прошло между FirstSeen и LastSeen (не суммарное время соединения а диапазон активности)
HitsPerMinute - Hits / SeenMinutes

Share - Это ключевой показатель для поиска "базовых" диапазонов и отсечения случайных CDN-всплесков. Значения близкие к 1.0 означают, что IP присутствует практически всегда (стабильный, возможно основной сервер). Близкие к нулю значения наоборот указывают на редкое, эпизодическое появление IP-адреса.

FirstSeen и LastSeen - полезны для понимания, давно ли используется адрес, и выявления разовых подключений.

HitsPerMinute - это, по сути, "плотность появления". Если IP стабильно держит соединение, то HitsPerMinute будет высокий, а если вспыхнул один раз, то низкий.

Помни, что CDN (Cloudflare, Fastly, Google) могут давать высокие Share, но при перезапуске клиента пул может смениться. Запускай скрипт в разные сессии для улучшения выборки!

ChangeLog:
1.1.0 (19:02:2026) - "ips_raw.log" и "unique_<process>.txt" теперь создаются в подпапке "raw"
1.0.0 (19:02:2026) - первая стабильная версия